% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/block_cutoff.R
\name{block_cutoff}
\alias{block_cutoff}
\title{Cluster pruning by Local Pratt Index (retain up to 5 per eligible cluster)}
\usage{
block_cutoff(
  cluster_info,
  marginal_effect,
  direct_effect,
  cutoff = 5,
  max_size = 5,
  contribution = 0.9
)
}
\arguments{
\item{cluster_info}{A data frame from \code{clump_cluster}, containing at least a
numeric column \code{cluster} giving the cluster index for each row; must be
row-aligned with the effect vectors.}

\item{marginal_effect}{Numeric vector of GWAS marginal effect sizes, row-aligned
with \code{cluster_info}. Must be standardized to a comparable scale
(e.g., z-scores) before calling this function.}

\item{direct_effect}{Numeric vector of direct effect sizes (from fine-mapping or PRS),
row-aligned with \code{cluster_info}. Must be standardized to a comparable
scale before calling. If estimated by SBayesRC, a common standardization is
\eqn{\beta*\sqrt{2*f*(1-f)}}, where \eqn{f} is the allele frequency.}

\item{cutoff}{Integer. Maximum cluster size threshold for pruning: clusters with
size \code{<= cutoff} are entirely kept; clusters with size \code{> cutoff} are
pruned using the Local Pratt rule.}

\item{max_size}{The maximum size of each cluster when using the Pratt index to cut off.}

\item{contribution}{Numeric in \eqn{(0,1]}. Target cumulative contribution (based on
normalized Local Pratt weights) used to decide how many top variants to retain
per pruned cluster; no more than 5 will be kept.}
}
\value{
A list with:
\itemize{
  \item \code{cluster_info_updated}: the pruned subset of \code{cluster_info}
  \item \code{selected_global_idx}: global row indices retained
  \item \code{dropped_global_idx}: global row indices removed
}
}
\description{
Given \code{cluster_info} produced by \code{clump_cluster} and two row-aligned
effect-size vectors \code{marginal_effect} and \code{direct_effect}, this function
prunes rows within clusters whose size exceeds \code{cutoff} by selecting, per such
cluster, at most the top 5 variants ranked by the local Pratt index accumulating their normalized contributions
until reaching \code{contribution}; if the threshold is not reached, the top 5 are kept.
Clusters with size \emph{less than or equal to} \code{cutoff} are fully retained.
}
