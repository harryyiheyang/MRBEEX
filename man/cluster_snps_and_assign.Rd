% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_snps_and_assign.R
\name{cluster_snps_and_assign}
\alias{cluster_snps_and_assign}
\title{Cluster SNPs (greedy by P) and assign every SNP to exactly one cluster}
\usage{
cluster_snps_and_assign(df, window_size = 1e+06)
}
\arguments{
\item{df}{A data.frame/data.table with columns: \code{SNP}, \code{CHR}, \code{BP}, and \code{P}.}

\item{window_size}{Integer, window radius in base pairs (e.g., \code{1e6} for ±1 Mb).}
}
\value{
A list with two data.tables:
\itemize{
  \item \code{centers}: cluster centers (like df1), columns \code{SNP, CHR, BP, P, ClusterSize, left, right, cluster_id}.
  \item \code{assigned}: original \code{df} annotated with \code{cluster} (ID), distance to center \code{dist_bp},
        and center metadata \code{center_SNP, center_BP, center_P}.
}
}
\description{
One-pass pipeline for C+T style clustering and membership assignment.
For each chromosome, repeatedly take the SNP with the smallest P as a center,
group all SNPs within \code{±window_size} bp into that cluster, remove them,
and continue until all SNPs are clustered. Then assign every SNP in \code{df}
to exactly one cluster by non-equi interval join with explicit tie-breaking
in overlapping regions: smallest distance to center, then smaller center P,
then smaller \code{cluster_id}.
}
